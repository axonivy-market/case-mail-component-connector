<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:ic="http://ivyteam.ch/jsf/component"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">
<h:body>
	<ui:composition template="/layouts/frame-10.xhtml">
		<ui:define name="title">RetrySendmailDetail</ui:define>
		<ui:define name="content">
			<h:form id="form">
				<p:messages />
				<p:panelGrid columns="2" layout="grid"
					styleClass="ui-panelgrid-blank ui-fluid"
					columnClasses="ui-g-12 ui-md-3 ui-lg-2, ui-g-12 ui-md-9 ui-lg-4, ui-g-12 ui-md-3 ui-lg-2, ui-g-12 ui-md-9 ui-lg-4">
					<h:outputText value="From" />
					<h:outputText value="#{data.mail.sender}" />
					<h:outputText value="To" />
					<h:outputText value="#{data.mail.recipient}" />
					<h:outputText value="Subject" />
					<h:outputText value="#{data.mail.subject}" />
					<h:outputText value="Content" />
					<h:outputText value="#{data.mail.body}" escape="false" />
				</p:panelGrid>
				<h3>Mail send history</h3>
				<p:dataTable id="taskDataTable" value="#{data.sendingMailTasks}"
					var="task" disabledTextSelection="false">
					<p:column headerText="DateTime" width="100">
						<h:outputText value="#{task.endTimestamp}"
							title="#{task.endTimestamp}">
							<f:convertDateTime pattern="MM/dd/yyyy HH:mm:ss" />
						</h:outputText>
					</p:column>
					<p:column headerText="ErrorMessage">
						<h:outputText
							value="#{task.customFields().stringField('mailErrorMessage').getOrDefault('')}"
							title="#{task.customFields().stringField('mailErrorMessage').getOrDefault('')}" />
					</p:column>
				</p:dataTable>
				<br />
				<div class="command-btns">
					<p:commandLink id="cancel"
						actionListener="#{ivyWorkflowView.cancel()}" process="@this"
						value="#{ivy.cms.co('/Button/cancel')}" />
					<p:commandButton id="abort" actionListener="#{logic.close}"
						value="#{ivy.cms.co('/Button/abort')}"
						title="#{ivy.cms.co('/Labels/abortTaskAndEnd')}"
						icon="pi pi-trash" styleClass="ui-button-danger">
						<p:confirm header="#{ivy.cms.co('/Labels/confirmation')}"
							message="#{ivy.cms.co('/Labels/abortTaskMessage')}"
							icon="si si-alert-circle" />
					</p:commandButton>
					<p:commandButton id="proceed" actionListener="#{logic.retry}"
						value="#{ivy.cms.co('/Button/retry')}"
						title="#{ivy.cms.co('/Labels/retryTooltip')}" update="form"
						icon="pi pi-refresh">
						<p:confirm header="#{ivy.cms.co('/Labels/confirmation')}"
							message="#{ivy.cms.co('/Labels/retrySendMailMessage')}"
							icon="si si-alert-circle" />
					</p:commandButton>
				</div>

				<p:confirmDialog global="true" showEffect="fade" hideEffect="fade"
					responsive="true" width="auto">
					<p:commandButton id="confirm-no-button"
						value="#{ivy.cms.co('/Button/no')}" type="button"
						styleClass="ui-confirmdialog-no ui-button-flat" />
					<p:commandButton id="confirm-yes-button"
						value="#{ivy.cms.co('/Button/yes')}" type="button"
						styleClass="ui-confirmdialog-yes" />
				</p:confirmDialog>
			</h:form>
		</ui:define>
	</ui:composition>
</h:body>

</html>
